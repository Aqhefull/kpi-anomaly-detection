(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{297:function(e,t,a){e.exports=a.p+"static/media/loading.3b928cd4.gif"},307:function(e,t,a){e.exports=a(694)},312:function(e,t,a){},694:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(23),o=a.n(i),c=(a(312),a(187)),s=a.n(c),l=a(286),u=a(51),d=a(40),m=a(41),h=a(59),v=a(58),y=a(60),p=a(36),f=a.n(p),D=a(287),g=a.n(D),E=a(97),w=a(288),b=a(3),B=a.n(b),k=a(71),C=a(298),I=a.n(C),M=a(302),O=a.n(M),j=a(299),L=a.n(j),S=a(300),x=a.n(S),N=a(186),H=a.n(N),T=a(42),K=a.n(T),G=a(304),W=a.n(G),P=a(191),R=a.n(P),F=a(301),A=a.n(F),V=a(303),X=a.n(V),z=a(127),J=a.n(z),U=a(188),q=a.n(U),$=a(189),Q=a.n($),Y=a(290),Z=a.n(Y),_=a(291),ee=a.n(_),te=a(695),ae=r.a.createElement("div",null,r.a.createElement(te.a,{to:"/",style:{textDecoration:"none"}},r.a.createElement(J.a,{button:!0},r.a.createElement(q.a,null,r.a.createElement(Z.a,null)),r.a.createElement(Q.a,{primary:"\u0413\u043e\u043b\u043e\u0432\u043d\u0430"}))),r.a.createElement(te.a,{to:"/activity",style:{textDecoration:"none"}},r.a.createElement(J.a,{button:!0},r.a.createElement(q.a,null,r.a.createElement(ee.a,null)),r.a.createElement(Q.a,{primary:"\u0410\u043a\u0442\u0438\u0432\u043d\u0456\u0441\u0442\u044c"})))),ne=a(128),re=a.n(ne),ie=a(129),oe=a.n(ie),ce=a(94),se=a.n(ce),le=a(95),ue=a.n(le),de=a(96),me=a.n(de),he=a(131),ve=a.n(he),ye=a(93),pe=a.n(ye),fe=a(81),De=a.n(fe);var ge=function(e){var t=e.movingBase,a=e.weekDay;return r.a.createElement(re.a,{width:"99%",height:320},r.a.createElement(oe.a,{data:t[a].data},r.a.createElement(ue.a,{dataKey:"timeDuration"}),r.a.createElement(me.a,null),r.a.createElement(ve.a,{vertical:!1,strokeDasharray:"3 3"}),r.a.createElement(pe.a,null),r.a.createElement(De.a,null),r.a.createElement(se.a,{name:"\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0456\u0449\u0435\u043d\u044c",type:"monotone",dataKey:"count",stroke:"#8884d8"})))},Ee=a(68),we=a.n(Ee),be=(a(256),a(31)),Be=50;var ke=Object(k.withStyles)({root:{width:"100%",height:"100%",overflowX:"auto"}})(function(e){var t=e.classes,a=e.targetElement;return r.a.createElement(we.a,{className:t.root},r.a.createElement(be.a,null,function(e){var t=e.width,n=e.height;return r.a.createElement(be.c,{width:t,height:n,headerHeight:50,rowHeight:Be,rowGetter:function(e){var t=e.index;return a[t]},rowCount:a.length,overscanRowCount:3},r.a.createElement(be.b,{width:50,label:"#",dataKey:"id"}),r.a.createElement(be.b,{width:200,label:"\u0414\u0430\u0442\u0430",dataKey:"date",cellDataGetter:function(e){var t=e.dataKey,a=e.rowData;return new Date(a[t]).toString()}}),r.a.createElement(be.b,{width:100,label:"\u0414\u0430\u0442\u0447\u0438\u043a",cellDataGetter:function(e){var t=e.dataKey;return e.rowData.device[t]},dataKey:"type"}),r.a.createElement(be.b,{width:100,label:"\u041b\u043e\u043a\u0430\u0446\u0456\u044f",cellDataGetter:function(e){var t=e.dataKey;return e.rowData.device[t]},dataKey:"location"}))}))}),Ce=a(135),Ie=a.n(Ce),Me=a(137),Oe=a.n(Me),je=a(136),Le=a.n(je),Se=a(138),xe=a.n(Se),Ne=a(697),He=a(696),Te=a(297),Ke=a.n(Te),Ge=a(185),We=a.n(Ge),Pe=function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.targetElement;return console.log("AnomalyTable: ",a),r.a.createElement(we.a,{className:t.root},r.a.createElement(be.a,null,function(e){var t=e.width,n=e.height;return r.a.createElement(be.c,{width:t,height:n,headerHeight:50,rowHeight:50,rowGetter:function(e){var t=e.index;return a[t]},rowCount:a.length,overscanRowCount:2},r.a.createElement(be.b,{width:50,label:"#",dataKey:"id"}),r.a.createElement(be.b,{width:200,label:"\u0427\u0430\u0441\u043e\u0432\u0438\u0439 \u0456\u043d\u0442\u0435\u0440\u0432\u0430\u043b",dataKey:"timeDuration"}),r.a.createElement(be.b,{width:200,label:"\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0456\u0449\u0435\u043d\u044c",dataKey:"count"}))}))}}]),t}(n.Component),Re=Object(k.withStyles)({root:{width:"100%",height:"300px",overflowX:"auto"}})(Pe),Fe=function(){function e(){Object(d.a)(this,e)}return Object(m.a)(e,[{key:"construct",value:function(){}},{key:"expectedValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=0;if(!e.length)return 0;for(var n=0;n<e.length;n++)a+=Math.pow(e[n],t)/.1;return a/(e.length/.1)}},{key:"standardDeviation",value:function(e,t){var a=this.expectedValue(e,2);return t=t||this.expectedValue(e),Math.sqrt(a-Math.pow(t,2))}},{key:"find",value:function(e,t){var a=this.expectedValue(e),n=this.standardDeviation(e,a);return!(Math.abs(a-t)<=3*n)}}]),e}(),Ae=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(v.a)(t).call(this,e))).state={anomalyDatabase:[],anomalySearchDone:!1,daysMiddle:0},a}return Object(y.a)(t,e),Object(m.a)(t,[{key:"searchAnomalyInData",value:function(e){for(var t=e.movingBase,a=e.weekDay,n=[],r=[],i=1,o=new Fe,c=0;c<t.length;c++){t[c].data.forEach(function(e){r.push(e.count)})}var s=r.reduce(function(e,t){return e+t},0);this.setState({daysMiddle:s/(r.length-1)*10});var l=r;t[a].data.forEach(function(e){o.find(l,e.count)&&(n.push({id:i,timeDuration:e.timeDuration,count:e.count}),i+=1)}),this.setState({anomalyDatabase:n,anomalySearchDone:!0})}},{key:"componentDidMount",value:function(){this.searchAnomalyInData(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.searchAnomalyInData(e)}},{key:"render",value:function(){var e=this.props,t=e.movingBase,a=e.weekDay;return r.a.createElement(r.a.Fragment,null,r.a.createElement(re.a,{width:"99%",height:320},r.a.createElement(oe.a,{data:t[a].data},r.a.createElement(ue.a,{dataKey:"timeDuration"}),r.a.createElement(me.a,null),r.a.createElement(ve.a,{vertical:!1,strokeDasharray:"3 3"}),r.a.createElement(pe.a,null),r.a.createElement(De.a,null),r.a.createElement(We.a,{y:this.state.daysMiddle,label:"\u041f\u0440\u0438\u0431\u043b\u0438\u0437\u043d\u0430 \u0430\u043d\u043e\u043c\u0430\u043b\u044c\u043d\u0430 \u043c\u0435\u0436\u0430",stroke:"red"}),r.a.createElement(se.a,{name:"\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0456\u0449\u0435\u043d\u044c",type:"monotone",dataKey:"count",dot:{stroke:"#3f51b5",strokeWidth:2}}))),r.a.createElement("div",null,this.state.anomalySearchDone?r.a.createElement("p",{style:{fontWeight:"700"}},"\u0417\u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0430\u043d\u043e\u043c\u0430\u043b\u0456\u0439: ",r.a.createElement("span",{style:{color:"red"}},this.state.anomalyDatabase.length)):null),this.state.anomalyDatabase.length?r.a.createElement(Re,{targetElement:this.state.anomalyDatabase}):null)}}]),t}(n.Component),Ve=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(v.a)(t).call(this,e))).handleDrawerOpen=function(){a.setState({open:!0})},a.handleDrawerClose=function(){a.setState({open:!1})},a.handleChange=function(e){a.setState(Object(E.a)({},e.target.name,e.target.value))},a.state={open:!0,weekDay:0,labelWidth:0},a}return Object(y.a)(t,e),Object(m.a)(t,[{key:"shouldComponentUpdate",value:function(e){return this.props.homeMoving.finalBaseDone!==e.homeMoving.finalBaseDone||!!this.props.homeMoving.finalBaseDone}},{key:"componentDidMount",value:function(){this.props.homeMoving.finalBaseDone&&this.setState({labelWidth:o.a.findDOMNode(this.InputLabelRef).offsetWidth})}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.homeMoving;return r.a.createElement(Ne.a,null,r.a.createElement("div",{className:a.root},r.a.createElement(I.a,null),r.a.createElement(L.a,{position:"absolute",className:B()(a.appBar,this.state.open&&a.appBarShift)},r.a.createElement(x.a,{disableGutters:!this.state.open,className:a.toolbar},r.a.createElement(R.a,{color:"inherit","aria-label":"Open drawer",onClick:this.handleDrawerOpen,className:B()(a.menuButton,this.state.open&&a.menuButtonHidden)},r.a.createElement(A.a,null)),r.a.createElement(K.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,className:a.title},"FEL | SmartGrid Watch System v. 1.0.0"))),r.a.createElement(O.a,{variant:"permanent",classes:{paper:B()(a.drawerPaper,!this.state.open&&a.drawerPaperClose)},open:this.state.open},r.a.createElement("div",{className:a.toolbarIcon},r.a.createElement(R.a,{onClick:this.handleDrawerClose},r.a.createElement(X.a,null))),r.a.createElement(W.a,null),r.a.createElement(H.a,null,ae)),r.a.createElement("main",{className:a.content},n.finalBaseDone?r.a.createElement(r.a.Fragment,null,r.a.createElement(He.a,{exact:!0,path:"/",render:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:a.appBarSpacer}),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},r.a.createElement(K.a,{variant:"h4",gutterBottom:!0,component:"h2"},"\u0410\u043a\u0442\u0438\u0432\u043d\u0456\u0441\u0442\u044c \u0437\u0430 \u0434\u0435\u043d\u044c"),r.a.createElement("form",{className:a.root,autoComplete:"off"},r.a.createElement(Ie.a,{className:a.formControl},r.a.createElement(Le.a,{htmlFor:"weekDay-simple"},"\u041e\u0431\u0435\u0440\u0456\u0442\u044c \u0434\u0435\u043d\u044c"),r.a.createElement(Oe.a,{value:e.state.weekDay,onChange:e.handleChange,inputProps:{name:"weekDay",id:"weekDay-simple"}},n.finalBase.map(function(e,t){return r.a.createElement(xe.a,{key:t,value:t},e.day)}))))),r.a.createElement(K.a,{component:"div",className:a.chartContainer},r.a.createElement(ge,{weekDay:e.state.weekDay,movingBase:n.finalBase})),r.a.createElement(K.a,{variant:"h4",gutterBottom:!0,component:"h2"},"\u041f\u043e\u043a\u0430\u0437\u0438 \u0434\u0430\u0442\u0447\u0438\u043a\u0456\u0432"),r.a.createElement("div",{className:a.tableContainer},r.a.createElement(ke,{targetElement:n.smartGrid})))}}),r.a.createElement(He.a,{path:"/activity",render:function(t){return r.a.createElement("div",null,r.a.createElement("div",{className:a.appBarSpacer}),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},r.a.createElement(K.a,{variant:"h4",gutterBottom:!0,component:"h2"},"\u0410\u043a\u0442\u0438\u0432\u043d\u0456\u0441\u0442\u044c \u0437\u0430 \u0434\u0435\u043d\u044c"),r.a.createElement("form",{className:a.root,autoComplete:"off"},r.a.createElement(Ie.a,{className:a.formControl},r.a.createElement(Le.a,{htmlFor:"weekDay-simple"},"\u041e\u0431\u0435\u0440\u0456\u0442\u044c \u0434\u0435\u043d\u044c"),r.a.createElement(Oe.a,{value:e.state.weekDay,onChange:e.handleChange,inputProps:{name:"weekDay",id:"weekDay-simple"}},n.finalBase.map(function(e,t){return r.a.createElement(xe.a,{key:t,value:t},e.day)}))))),r.a.createElement(Ae,Object.assign({},t,{weekDay:e.state.weekDay,movingBase:n.finalBase})))}}),r.a.createElement(He.a,{render:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:a.appBarSpacer}),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},r.a.createElement(K.a,{variant:"h4",gutterBottom:!0,component:"h2"},"\u0410\u043a\u0442\u0438\u0432\u043d\u0456\u0441\u0442\u044c \u0437\u0430 \u0434\u0435\u043d\u044c"),r.a.createElement("form",{className:a.root,autoComplete:"off"},r.a.createElement(Ie.a,{className:a.formControl},r.a.createElement(Le.a,{htmlFor:"weekDay-simple"},"\u041e\u0431\u0435\u0440\u0456\u0442\u044c \u0434\u0435\u043d\u044c"),r.a.createElement(Oe.a,{value:e.state.weekDay,onChange:e.handleChange,inputProps:{name:"weekDay",id:"weekDay-simple"}},n.finalBase.map(function(e,t){return r.a.createElement(xe.a,{key:t,value:t},e.day)}))))),r.a.createElement(K.a,{component:"div",className:a.chartContainer},r.a.createElement(ge,{weekDay:e.state.weekDay,movingBase:n.finalBase})),r.a.createElement(K.a,{variant:"h4",gutterBottom:!0,component:"h2"},"\u041f\u043e\u043a\u0430\u0437\u0438 \u0434\u0430\u0442\u0447\u0438\u043a\u0456\u0432"),r.a.createElement("div",{className:a.tableContainer},r.a.createElement(ke,{targetElement:n.smartGrid})))}})):r.a.createElement("div",{className:"preloader"},r.a.createElement("img",{src:Ke.a,alt:"Loading.."})))))}}]),t}(n.Component),Xe=Object(k.withStyles)(function(e){return{root:{display:"flex"},formControl:{margin:e.spacing.unit,minWidth:120},selectEmpty:{marginTop:2*e.spacing.unit},toolbar:{paddingRight:24},toolbarIcon:Object(w.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:240,width:"calc(100% - ".concat(240,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginLeft:12,marginRight:36},menuButtonHidden:{display:"none"},title:{flexGrow:1},drawerPaper:{position:"relative",whiteSpace:"nowrap",width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerPaperClose:Object(E.a)({overflowX:"hidden",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),width:7*e.spacing.unit},e.breakpoints.up("sm"),{width:9*e.spacing.unit}),appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,padding:3*e.spacing.unit,height:"100vh",overflow:"auto",position:"relative"},chartContainer:{marginLeft:-22},tableContainer:{height:320},h5:{marginBottom:2*e.spacing.unit}}})(Ve),ze=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(v.a)(t).call(this,e))).state={finalBaseDone:!1,smartGrid:{},deviceLocation:"",currentDay:0,currentDate:"",deviceLocationMoved:0,deviceLocationMovedBase:[],currDayIntervals:[],currDayIntervalsCounter:0,currentDayIteration:0,finalBase:[]},a}return Object(y.a)(t,e),Object(m.a)(t,[{key:"generateCurrDayIntervals",value:function(){var e=f()().set({h:0,m:0,s:0}).valueOf()+6e4*this.state.currDayIntervalsCounter,t=f()().set({h:0,m:5,s:0}).valueOf()+6e4*this.state.currDayIntervalsCounter;"00:00:00"===f()(t).format("HH:mm:ss")&&(t=f()().set({h:23,m:59,s:59}).valueOf()),this.setState({currDayIntervals:Object(u.a)(this.state.currDayIntervals).concat([{startTime:f()(e).format("HH:mm:ss"),endTime:f()(t).format("HH:mm:ss")}]),currDayIntervalsCounter:this.state.currDayIntervalsCounter+5})}},{key:"renderHouseMoveTable",value:function(e){e:for(var t=this.state.currentDay;t<2*(this.state.currentDay+1);t++)t:for(var a=0;a<288;a++){this.generateCurrDayIntervals();for(var n=this.state.currentDayIteration;n<e.data.days.length;n++){if(n===e.data.days.length-1)break e;var r=e.data.days[n];r.id=n;var i=f()(r.date).calendar(),o=f()(r.date).format("HH:mm:ss");if(i!==this.state.currentDate){if(0===this.state.finalBase.length){this.setState({deviceLocationMovedBase:[],deviceLocationMoved:0,currentDate:i,currDayIntervals:[],currDayIntervalsCounter:0,finalBase:Object(u.a)(this.state.finalBase).concat([{day:this.state.currentDate,data:this.state.deviceLocationMovedBase}]),currentDayIteration:n}),console.log("%c -> Day render ".concat(this.state.currentDay," .."),"background: #20c997; color: #000");break t}for(var c=0;c<this.state.finalBase.length;c++){if(this.state.finalBase[c].day!==this.state.currentDate){this.setState({deviceLocationMovedBase:[],deviceLocationMoved:0,currentDate:i,currDayIntervals:[],currDayIntervalsCounter:0,finalBase:Object(u.a)(this.state.finalBase).concat([{day:this.state.currentDate,data:this.state.deviceLocationMovedBase}]),currentDayIteration:n}),console.log("%c -> Day render ".concat(this.state.currentDay," .."),"background: #20c997; color: #000");break t}}}if(o>this.state.currDayIntervals[a].startTime&&o<this.state.currDayIntervals[a].endTime){if(r.device.location!==this.state.deviceLocation&&this.setState({deviceLocation:r.device.location,deviceLocationMoved:this.state.deviceLocationMoved+1,currentDayIteration:n}),e.data.days[n+1]&&f()(e.data.days[n+1].date).calendar()!==i){this.setState({deviceLocationMovedBase:Object(u.a)(this.state.deviceLocationMovedBase).concat([{count:this.state.deviceLocationMoved,timeDuration:"".concat(this.state.currDayIntervals[a].startTime," - ").concat(this.state.currDayIntervals[a].endTime),date:this.state.currentDate}]),currentDayIteration:n+1,currentDay:this.state.currentDay+1});break}if(void 0===e.data.days[n+1]){this.setState({deviceLocationMovedBase:Object(u.a)(this.state.deviceLocationMovedBase).concat([{count:this.state.deviceLocationMoved,timeDuration:"".concat(this.state.currDayIntervals[a].startTime," - ").concat(this.state.currDayIntervals[a].endTime),date:this.state.currentDate}]),deviceLocationMoved:0,currentDayIteration:n}),this.setState({deviceLocationMovedBase:[],deviceLocationMoved:0,currentDate:i,currDayIntervals:[],currDayIntervalsCounter:0,finalBase:Object(u.a)(this.state.finalBase).concat([{day:this.state.currentDate,data:this.state.deviceLocationMovedBase}]),currentDayIteration:n});break t}}if(o>this.state.currDayIntervals[a].endTime){this.setState({deviceLocationMovedBase:Object(u.a)(this.state.deviceLocationMovedBase).concat([{count:this.state.deviceLocationMoved,timeDuration:"".concat(this.state.currDayIntervals[a].startTime," - ").concat(this.state.currDayIntervals[a].endTime),date:this.state.currentDate}]),deviceLocationMoved:0,currentDayIteration:n});break}}}}},{key:"componentDidMount",value:function(){var e=Object(l.a)(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.get("./Msn3.json");case 3:t=e.sent,this.setState({deviceLocation:t.data.days[0].device.location,currentDate:f()(t.data.days[0].date).calendar()}),console.log("%c -> Day render ".concat(this.state.currentDay," .."),"background: #20c997; color: #000"),this.renderHouseMoveTable(t),this.setState({deviceLocationMovedBase:[],deviceLocationMoved:0,currDayIntervals:[],currDayIntervalsCounter:0,finalBase:Object(u.a)(this.state.finalBase).concat([{day:this.state.currentDate,data:this.state.deviceLocationMovedBase}]),smartGrid:t.data.days}),console.log("RESULT: ",this.state),this.setState({finalBaseDone:!0}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}},e,this,[[0,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(Xe,{homeMoving:this.state})}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(ze,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[307,2,1]]]);
//# sourceMappingURL=main.bb118c29.chunk.js.map